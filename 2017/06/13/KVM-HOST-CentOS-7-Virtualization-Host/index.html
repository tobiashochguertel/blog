<!doctype html><html class="theme-next muse" lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/blog/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css"><link href="/blog/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/blog/css/main.css?v=5.1.1" rel="stylesheet" type="text/css"><meta name="keywords" content="KVM,virt-install,"><link rel="alternate" href="/blog/atom.xml" title="TH's Notes" type="application/atom+xml"><link rel="shortcut icon" type="image/x-icon" href="/blog/favicon.ico?v=5.1.1"><meta name="description" content="CENTOS 7 VIRTUALIZATION HOST"><meta name="keywords" content="KVM,virt-install"><meta property="og:type" content="article"><meta property="og:title" content="KVM HOST CentOS 7 Virtualization Host"><meta property="og:url" content="https://tobiashochguertel.github.io/blog/2017/06/13/KVM-HOST-CentOS-7-Virtualization-Host/index.html"><meta property="og:site_name" content="TH&#39;s Notes"><meta property="og:description" content="CENTOS 7 VIRTUALIZATION HOST"><meta property="og:image" content="https://tobiashochguertel.github.io/blog/2017/06/13/KVM-HOST-CentOS-7-Virtualization-Host/KVM-HOST-CentOS-7-Virtualization-Host0.png"><meta property="og:updated_time" content="2017-06-15T23:59:13.591Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="KVM HOST CentOS 7 Virtualization Host"><meta name="twitter:description" content="CENTOS 7 VIRTUALIZATION HOST"><meta name="twitter:image" content="https://tobiashochguertel.github.io/blog/2017/06/13/KVM-HOST-CentOS-7-Virtualization-Host/KVM-HOST-CentOS-7-Virtualization-Host0.png"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/blog/",scheme:"Muse",sidebar:{use_motion:!1,position:"left",display:"post",offset:12,offset_float:0,b2t:!1,scrollpercent:!0},fancybox:!0,motion:!1,duoshuo:{userId:"0",author:"Author"},algolia:{applicationID:"2CYZLG2CZW",apiKey:"e374744de565b88b0818474de1a6edce",indexName:"blog",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="https://tobiashochguertel.github.io/blog/2017/06/13/KVM-HOST-CentOS-7-Virtualization-Host/"><title>KVM HOST CentOS 7 Virtualization Host | TH's Notes</title><script>!function(e,t,a,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=t.createElement(a),s=t.getElementsByTagName(a)[0],o.async=1,o.src="https://www.google-analytics.com/analytics.js",s.parentNode.insertBefore(o,s)}(window,document,"script",0,"ga"),ga("create","UA-57328451-7","auto"),ga("send","pageview")</script></head><body itemscope itemtype="http://schema.org/WebPage" lang="en"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/blog/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">TH's Notes</span> <span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description"></h1></div><div class="site-nav-toggle"><button><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/blog/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>Home</a></li><li class="menu-item menu-item-tags"><a href="/blog/tags" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>Tags</a></li><li class="menu-item menu-item-categories"><a href="/blog/categories" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>Categories</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br>Search</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i> </span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"><input autocomplete="off" placeholder="Searching..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><link itemprop="mainEntityOfPage" href="https://tobiashochguertel.github.io/blog/blog/2017/06/13/KVM-HOST-CentOS-7-Virtualization-Host/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="Tobias Hochgürtel"><meta itemprop="description" content=""><meta itemprop="image" content="/blog/images/tobias_hochguertel.jpg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="TH's Notes"></span><header class="post-header"><h2 class="post-title" itemprop="name headline">KVM HOST CentOS 7 Virtualization Host</h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-06-13T18:01:15+02:00">2017-06-13 </time></span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/blog/categories/IT-Operations/" itemprop="url" rel="index"><span itemprop="name">IT Operations</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><h1 id="CENTOS-7-VIRTUALIZATION-HOST"><a href="#CENTOS-7-VIRTUALIZATION-HOST" class="headerlink" title="CENTOS 7 VIRTUALIZATION HOST"></a>CENTOS 7 VIRTUALIZATION HOST</h1><a id="more"></a><ul><li><a href="http://jensd.be/207/linux/install-and-use-centos-7-as-kvm-virtualization-host" target="_blank" rel="external">install-and-use-centos-7-as-kvm-virtualization-host</a></li><li><a href="https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Virtualization_Host_Configuration_and_Guest_Installation_Guide/chap-Virtualization_Host_Configuration_and_Guest_Installation_Guide-Guest_Installation.html" target="_blank" rel="external">Chapter 6. Guest virtual machine installation overview</a></li><li><a href="https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Virtualization_Host_Configuration_and_Guest_Installation_Guide/chap-Virtualization_Host_Configuration_and_Guest_Installation_Guide-RHEL6_Install.html" target="_blank" rel="external">Chapter 7. Installing a Red Hat Enterprise Linux 6 guest virtual machine on a Red Hat Enterprise Linux 6 host</a></li></ul><p><strong>Host:</strong> the machine that host other systems, KVM will be installed on this machine.<br><strong>Guest:</strong> the system running in the host, also refered to as VM, Virtual Machine or domain.<br><strong>Hypervisor:</strong> the piece of software that enables virtualization on the host. For example KVM, ESXi, Xen, …</p><p><strong>File: <code>host</code></strong><br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">192.168.2.22 kvmhost kvmhost.hochguertel.biz</div></pre></td></tr></table></figure><p></p><p><strong>SSH-Key austauschen:</strong><br></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">ssh root@kvmhost</div><div class="line">mkdir .ssh</div><div class="line">chmod 600 .ssh</div><div class="line">exit</div><div class="line">cat ~/.ssh/*.pub | ssh root@kvmhost "cat &gt;&gt; ~/.ssh/authorized_keys"</div></pre></td></tr></table></figure><p></p><h2 id="KVM-hypervisor-and-VM-extensions"><a href="#KVM-hypervisor-and-VM-extensions" class="headerlink" title="KVM hypervisor and VM-extensions"></a>KVM hypervisor and VM-extensions</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">egrep -c '(vmx|svm)' /proc/cpuinfo</div></pre></td></tr></table></figure><p><em>Log: <code>egrep -c &#39;(vmx|svm)&#39; /proc/cpuinfo</code></em><br></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[root@kvmhost ~]# egrep -c '(vmx|svm)' /proc/cpuinfo</div><div class="line">4</div></pre></td></tr></table></figure><p></p><p><em>Log: <code>cat /proc/cpuinfo</code></em><br></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div></pre></td><td class="code"><pre><div class="line">[root@kvmhost ~]# cat /proc/cpuinfo</div><div class="line">processor       : 0</div><div class="line">vendor_id       : GenuineIntel</div><div class="line">cpu family      : 6</div><div class="line">model           : 42</div><div class="line">model name      : Intel(R) Core(TM) i5-2467M CPU @ 1.60GHz</div><div class="line">stepping        : 7</div><div class="line">microcode       : 0x29</div><div class="line">cpu MHz         : 799.937</div><div class="line">cache size      : 3072 KB</div><div class="line">physical id     : 0</div><div class="line">siblings        : 4</div><div class="line">core id         : 0</div><div class="line">cpu cores       : 2</div><div class="line">apicid          : 0</div><div class="line">initial apicid  : 0</div><div class="line">fpu             : yes</div><div class="line">fpu_exception   : yes</div><div class="line">cpuid level     : 13</div><div class="line">wp              : yes</div><div class="line">flags           : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx rdtscp lm constant_tsc arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc aperfmperf eagerfpu pni pclmulqdq dtes64 monitor ds_cpl vmx est tm2 ssse3 cx16 xtpr pdcm pcid sse4_1 sse4_2 x2apic popcnt tsc_deadline_timer aes xsave avx lahf_lm ida arat epb xsaveopt pln pts dtherm tpr_shadow vnmi flexpriority ept vpid</div><div class="line">bogomips        : 3192.69</div><div class="line">clflush size    : 64</div><div class="line">cache_alignment : 64</div><div class="line">address sizes   : 36 bits physical, 48 bits virtual</div><div class="line">power management:</div><div class="line"></div><div class="line">processor       : 1</div><div class="line">vendor_id       : GenuineIntel</div><div class="line">cpu family      : 6</div><div class="line">model           : 42</div><div class="line">model name      : Intel(R) Core(TM) i5-2467M CPU @ 1.60GHz</div><div class="line">stepping        : 7</div><div class="line">microcode       : 0x29</div><div class="line">cpu MHz         : 804.625</div><div class="line">cache size      : 3072 KB</div><div class="line">physical id     : 0</div><div class="line">siblings        : 4</div><div class="line">core id         : 0</div><div class="line">cpu cores       : 2</div><div class="line">apicid          : 1</div><div class="line">initial apicid  : 1</div><div class="line">fpu             : yes</div><div class="line">fpu_exception   : yes</div><div class="line">cpuid level     : 13</div><div class="line">wp              : yes</div><div class="line">flags           : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx rdtscp lm constant_tsc arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc aperfmperf eagerfpu pni pclmulqdq dtes64 monitor ds_cpl vmx est tm2 ssse3 cx16 xtpr pdcm pcid sse4_1 sse4_2 x2apic popcnt tsc_deadline_timer aes xsave avx lahf_lm ida arat epb xsaveopt pln pts dtherm tpr_shadow vnmi flexpriority ept vpid</div><div class="line">bogomips        : 3192.69</div><div class="line">clflush size    : 64</div><div class="line">cache_alignment : 64</div><div class="line">address sizes   : 36 bits physical, 48 bits virtual</div><div class="line">power management:</div><div class="line"></div><div class="line">processor       : 2</div><div class="line">vendor_id       : GenuineIntel</div><div class="line">cpu family      : 6</div><div class="line">model           : 42</div><div class="line">model name      : Intel(R) Core(TM) i5-2467M CPU @ 1.60GHz</div><div class="line">stepping        : 7</div><div class="line">microcode       : 0x29</div><div class="line">cpu MHz         : 800.000</div><div class="line">cache size      : 3072 KB</div><div class="line">physical id     : 0</div><div class="line">siblings        : 4</div><div class="line">core id         : 1</div><div class="line">cpu cores       : 2</div><div class="line">apicid          : 2</div><div class="line">initial apicid  : 2</div><div class="line">fpu             : yes</div><div class="line">fpu_exception   : yes</div><div class="line">cpuid level     : 13</div><div class="line">wp              : yes</div><div class="line">flags           : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx rdtscp lm constant_tsc arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc aperfmperf eagerfpu pni pclmulqdq dtes64 monitor ds_cpl vmx est tm2 ssse3 cx16 xtpr pdcm pcid sse4_1 sse4_2 x2apic popcnt tsc_deadline_timer aes xsave avx lahf_lm ida arat epb xsaveopt pln pts dtherm tpr_shadow vnmi flexpriority ept vpid</div><div class="line">bogomips        : 3192.69</div><div class="line">clflush size    : 64</div><div class="line">cache_alignment : 64</div><div class="line">address sizes   : 36 bits physical, 48 bits virtual</div><div class="line">power management:</div><div class="line"></div><div class="line">processor       : 3</div><div class="line">vendor_id       : GenuineIntel</div><div class="line">cpu family      : 6</div><div class="line">model           : 42</div><div class="line">model name      : Intel(R) Core(TM) i5-2467M CPU @ 1.60GHz</div><div class="line">stepping        : 7</div><div class="line">microcode       : 0x29</div><div class="line">cpu MHz         : 800.000</div><div class="line">cache size      : 3072 KB</div><div class="line">physical id     : 0</div><div class="line">siblings        : 4</div><div class="line">core id         : 1</div><div class="line">cpu cores       : 2</div><div class="line">apicid          : 3</div><div class="line">initial apicid  : 3</div><div class="line">fpu             : yes</div><div class="line">fpu_exception   : yes</div><div class="line">cpuid level     : 13</div><div class="line">wp              : yes</div><div class="line">flags           : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx rdtscp lm constant_tsc arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc aperfmperf eagerfpu pni pclmulqdq dtes64 monitor ds_cpl vmx est tm2 ssse3 cx16 xtpr pdcm pcid sse4_1 sse4_2 x2apic popcnt tsc_deadline_timer aes xsave avx lahf_lm ida arat epb xsaveopt pln pts dtherm tpr_shadow vnmi flexpriority ept vpid</div><div class="line">bogomips        : 3192.69</div><div class="line">clflush size    : 64</div><div class="line">cache_alignment : 64</div><div class="line">address sizes   : 36 bits physical, 48 bits virtual</div><div class="line">power management:</div></pre></td></tr></table></figure><p></p><h3 id="KVM-installation"><a href="#KVM-installation" class="headerlink" title="KVM installation"></a>KVM installation</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">yum install kvm virt-manager libvirt virt-install qemu policycoreutils-python</div><div class="line">yum -y install @virt* dejavu-lgc-* xorg-x11-xauth tigervnc libguestfs-tools policycoreutils-python bridge-utils</div></pre></td></tr></table></figure><h3 id="Networking"><a href="#Networking" class="headerlink" title="Networking"></a>Networking</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">echo "net.ipv4.ip_forward = 1"|sudo tee /etc/sysctl.d/99-ipforward.conf</div><div class="line">sysctl -p /etc/sysctl.d/99-ipforward.conf</div><div class="line">ifconfig -a</div></pre></td></tr></table></figure><p><em>Log: <code>ifconfig -a</code></em><br></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">[root@kvmhost ~]# ifconfig -a</div><div class="line">lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536</div><div class="line">        inet 127.0.0.1  netmask 255.0.0.0</div><div class="line">        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;</div><div class="line">        loop  txqueuelen 0  (Lokale Schleife)</div><div class="line">        RX packets 132  bytes 11824 (11.5 KiB)</div><div class="line">        RX errors 0  dropped 0  overruns 0  frame 0</div><div class="line">        TX packets 132  bytes 11824 (11.5 KiB)</div><div class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</div><div class="line"></div><div class="line">virbr0: flags=4099&lt;UP,BROADCAST,MULTICAST&gt;  mtu 1500</div><div class="line">        inet 192.168.122.1  netmask 255.255.255.0  broadcast 192.168.122.255</div><div class="line">        ether 52:54:00:9e:f3:99  txqueuelen 0  (Ethernet)</div><div class="line">        RX packets 0  bytes 0 (0.0 B)</div><div class="line">        RX errors 0  dropped 0  overruns 0  frame 0</div><div class="line">        TX packets 0  bytes 0 (0.0 B)</div><div class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</div><div class="line"></div><div class="line">virbr0-nic: flags=4098&lt;BROADCAST,MULTICAST&gt;  mtu 1500</div><div class="line">        ether 52:54:00:9e:f3:99  txqueuelen 500  (Ethernet)</div><div class="line">        RX packets 0  bytes 0 (0.0 B)</div><div class="line">        RX errors 0  dropped 0  overruns 0  frame 0</div><div class="line">        TX packets 0  bytes 0 (0.0 B)</div><div class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</div><div class="line"></div><div class="line">wlp2s0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</div><div class="line">        inet 192.168.2.22  netmask 255.255.0.0  broadcast 192.168.255.255</div><div class="line">        inet6 2003:46:762:a900:76de:2bff:fe6a:fa2e  prefixlen 64  scopeid 0x0&lt;global&gt;</div><div class="line">        inet6 fe80::76de:2bff:fe6a:fa2e  prefixlen 64  scopeid 0x20&lt;link&gt;</div><div class="line">        ether 74:de:2b:6a:fa:2e  txqueuelen 1000  (Ethernet)</div><div class="line">        RX packets 37309  bytes 46095805 (43.9 MiB)</div><div class="line">        RX errors 0  dropped 0  overruns 0  frame 0</div><div class="line">        TX packets 20606  bytes 2591387 (2.4 MiB)</div><div class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</div></pre></td></tr></table></figure><p></p><ul><li><a href="http://grokbase.com/t/centos/centos/147wwsaaz8/wireless-inteface-configure-as-bridge#201407289vhyxwcr2xt65947721pf6wh90" target="_blank" rel="external">Wifi Devices can’t be bridged!</a><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">How did you come to this conclusion? Based on which reading?</div><div class="line"></div><div class="line">https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/Networking_Guide/</div><div class="line"></div><div class="line">Is there any utility or tool to use to scan wireless device in network and</div><div class="line">connect them as i want to stop to use Networkmanager to use laptop wireless</div><div class="line">interface as bridge for my guest vm.</div><div class="line"></div><div class="line">You cannot do what you want</div><div class="line"></div><div class="line">https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/Networking_Guide/ch-Configure_Network_Bridging.html</div><div class="line"></div><div class="line">&quot;Note that a bridge cannot be established over Wi-Fi networks operating</div><div class="line">in Ad-Hoc or Infrastructure modes. This is due to the IEEE 802.11</div><div class="line">standard that specifies the use of 3-address frames in Wi-Fi for the</div><div class="line">efficient use of airtime.&quot;</div><div class="line"></div><div class="line">Thx</div><div class="line">Ben</div><div class="line"></div><div class="line">Alexander</div></pre></td></tr></table></figure></li></ul><p><strong>File: <code>/etc/sysconfig/network-scripts/ifcfg-enp0226u1u2</code></strong><br></p><figure class="highlight ini"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="attr">DEVICE</span>=enp0s26u1u2</div><div class="line"><span class="attr">HWADDR</span>=F4:F9:<span class="number">51</span>:F2:<span class="number">82</span>:<span class="number">7</span>F</div><div class="line"><span class="attr">TYPE</span>=Ethernet</div><div class="line"><span class="comment">#BOOTPROTO=dhcp</span></div><div class="line"><span class="attr">DEFROUTE</span>=<span class="literal">yes</span></div><div class="line"><span class="attr">IPV4_FAILURE_FATAL</span>=<span class="literal">no</span></div><div class="line"><span class="attr">IPV6INIT</span>=<span class="literal">yes</span></div><div class="line"><span class="attr">IPV6_AUTOCONF</span>=<span class="literal">yes</span></div><div class="line"><span class="attr">IPV6_DEFROUTE</span>=<span class="literal">yes</span></div><div class="line"><span class="attr">IPV6_FAILURE_FATAL</span>=<span class="literal">no</span></div><div class="line"><span class="attr">NAME</span>=enp0s26u1u2</div><div class="line"><span class="attr">ONBOOT</span>=<span class="literal">yes</span></div><div class="line"><span class="attr">PEERDNS</span>=<span class="literal">yes</span></div><div class="line"><span class="attr">PEERROUTES</span>=<span class="literal">yes</span></div><div class="line"><span class="attr">IPV6_PEERDNS</span>=<span class="literal">yes</span></div><div class="line"><span class="attr">IPV6_PEERROUTES</span>=<span class="literal">yes</span></div><div class="line"><span class="attr">BRIDGE</span>=virbr0</div></pre></td></tr></table></figure><p></p><p><strong>File: <code>/etc/sysconfig/network-scripts/ifcfg-virbr0-enp0226u1u2</code></strong><br></p><figure class="highlight ini"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="attr">DEVICE</span>=virbr0</div><div class="line"><span class="attr">TYPE</span>=BRIDGE</div><div class="line"><span class="attr">BOOTPROTO</span>=static</div><div class="line"><span class="comment">#DEFROUTE=yes</span></div><div class="line"><span class="attr">IPV4_FAILURE_FATAL</span>=<span class="literal">no</span></div><div class="line"><span class="attr">IPV6INIT</span>=<span class="literal">yes</span></div><div class="line"><span class="attr">IPV6_AUTOCONF</span>=<span class="literal">yes</span></div><div class="line"><span class="comment">#IPV6_DEFROUTE=yes</span></div><div class="line"><span class="attr">IPV6_FAILURE_FATAL</span>=<span class="literal">no</span></div><div class="line"><span class="attr">NAME</span>=enp0s26u1u2</div><div class="line"><span class="attr">ONBOOT</span>=<span class="literal">yes</span></div><div class="line"><span class="attr">PEERDNS</span>=<span class="literal">yes</span></div><div class="line"><span class="attr">PEERROUTES</span>=<span class="literal">yes</span></div><div class="line"><span class="attr">IPV6_PEERDNS</span>=<span class="literal">yes</span></div><div class="line"><span class="attr">IPV6_PEERROUTES</span>=<span class="literal">yes</span></div><div class="line"><span class="attr">IPADDR</span>=<span class="string">"192.168.3.101"</span></div><div class="line"><span class="attr">NETMASK</span>=<span class="string">"255.255.0.0"</span></div><div class="line"><span class="attr">GATEWAY</span>=<span class="string">"192.168.3.1"</span></div><div class="line"><span class="attr">DNS1</span>=<span class="string">"192.168.3.1"</span></div></pre></td></tr></table></figure><p></p><p><strong>File: <code>/etc/sysconfig/network-scripts/ifcfg-enp0226u1u2</code></strong><br></p><figure class="highlight ini"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="attr">DEVICE</span>=enp0s26u1u2</div><div class="line"><span class="attr">HWADDR</span>=F4:F9:<span class="number">51</span>:F2:<span class="number">82</span>:<span class="number">7</span>F</div><div class="line"><span class="attr">TYPE</span>=Ethernet</div><div class="line"><span class="attr">NAME</span>=enp0s26u1u2</div><div class="line"><span class="attr">ONBOOT</span>=<span class="literal">yes</span></div><div class="line"><span class="attr">BRIDGE</span>=virbr0</div></pre></td></tr></table></figure><p></p><p><strong>File: <code>/etc/sysconfig/network-scripts/ifcfg-virbr0-enp0226u1u2</code></strong><br></p><figure class="highlight ini"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="attr">DEVICE</span>=virbr0</div><div class="line"><span class="attr">TYPE</span>=BRIDGE</div><div class="line"><span class="attr">BOOTPROTO</span>=static</div><div class="line"><span class="attr">NAME</span>=enp0s26u1u2</div><div class="line"><span class="attr">ONBOOT</span>=<span class="literal">yes</span></div><div class="line"><span class="attr">IPADDR</span>=<span class="string">"192.168.3.101"</span></div><div class="line"><span class="attr">NETMASK</span>=<span class="string">"255.255.0.0"</span></div></pre></td></tr></table></figure><p></p><h3 id="Finish-and-check-the-KVM-installation"><a href="#Finish-and-check-the-KVM-installation" class="headerlink" title="Finish and check the KVM installation"></a>Finish and check the KVM installation</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">lsmod | grep kvm</div><div class="line">ip a show virbr0</div><div class="line">virsh -c qemu:///system list</div></pre></td></tr></table></figure><p><em>Log: <code>lsmod | grep kvm</code></em><br></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[root@kvmhost /]# lsmod | grep kvm</div><div class="line">kvm_intel             148081  0</div><div class="line">kvm                   461126  1 kvm_intel</div></pre></td></tr></table></figure><p></p><p><em>Log: <code>ip a show virbr0</code></em><br></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">[root@kvmhost /]# ip a show virbr0</div><div class="line">4: virbr0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP</div><div class="line">    link/ether f4:f9:51:f2:82:7f brd ff:ff:ff:ff:ff:ff</div><div class="line">    inet 192.168.3.101/16 brd 192.168.255.255 scope global virbr0</div><div class="line">       valid_lft forever preferred_lft forever</div><div class="line">    inet6 fdaa:fabb:cbd7:1:f6f9:51ff:fef2:827f/64 scope global dynamic</div><div class="line">       valid_lft 1814391sec preferred_lft 604791sec</div><div class="line">    inet6 fe80::f6f9:51ff:fef2:827f/64 scope link</div><div class="line">       valid_lft forever preferred_lft forever</div></pre></td></tr></table></figure><p></p><p><em>Log: <code>virsh -c qemu:///system list</code></em><br></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[root@kvmhost /]# virsh -c qemu:///system list</div><div class="line"> Id    Name                           Status</div><div class="line">----------------------------------------------------</div></pre></td></tr></table></figure><p></p><h2 id="Using-KVM-with-the-CLI"><a href="#Using-KVM-with-the-CLI" class="headerlink" title="Using KVM with the CLI"></a>Using KVM with the CLI</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div></pre></td><td class="code"><pre><div class="line">[root@kvmhost /]# virt-install --help</div><div class="line">usage: virt-install --name NAME --ram RAM STORAGE INSTALL [options]</div><div class="line"></div><div class="line">Neue virtuelle Maschine von festgelegten Installations-Medien erstellen.</div><div class="line"></div><div class="line">optional arguments:</div><div class="line">  -h, --help            show this help message and exit</div><div class="line">  --version             show program's version number and exit</div><div class="line">  --connect URI         Verbindung zum Hypervisor mit libvirt URI</div><div class="line"></div><div class="line">Allgemeine Optionen:</div><div class="line">  -n NAME, --name NAME  Name der Gastinstanz</div><div class="line">  --memory MEMORY       Configure guest memory allocation. Ex:</div><div class="line">                        --memory 1024 (in MiB)</div><div class="line">                        --memory 512,maxmemory=1024</div><div class="line">  --vcpus VCPUS         Number of vcpus to configure for your guest. Ex:</div><div class="line">                        --vcpus 5</div><div class="line">                        --vcpus 5,maxcpus=10,cpuset=1-4,6,8</div><div class="line">                        --vcpus sockets=2,cores=4,threads=2,</div><div class="line">  --cpu CPU             CPU model and features. Ex:</div><div class="line">                        --cpu coreduo,+x2apic</div><div class="line">                        --cpu host</div><div class="line">  --metadata METADATA   Configure guest metadata. Ex:</div><div class="line">                        --metadata name=foo,title="My pretty title",uuid=...</div><div class="line">                        --metadata description="My nice long description"</div><div class="line">  --security SECURITY   Erstellen Sie die Domänen-Sicherheit Treiber-</div><div class="line">                        Konfiguration.</div><div class="line">  --numatune NUMATUNE   Stimmen Sie die NUMA Richtlinie auf die Domänen</div><div class="line">                        Verarbeitung ab.</div><div class="line">  --memtune MEMTUNE     Tune memory policy for the domain process.</div><div class="line">  --blkiotune BLKIOTUNE</div><div class="line">                        Tune blkio policy for the domain process.</div><div class="line">  --memorybacking MEMORYBACKING</div><div class="line">                        Set memory backing policy for the domain process. Ex:</div><div class="line">                        --memorybacking hugepages=on</div><div class="line">  --features FEATURES   Set domain &lt;features&gt; XML. Ex:</div><div class="line">                        --features acpi=off</div><div class="line">                        --features apic=on,eoi=on</div><div class="line">  --clock CLOCK         Set domain &lt;clock&gt; XML. Ex:</div><div class="line">                        --clock offset=localtime,rtc_tickpolicy=catchup</div><div class="line">  --pm PM               Configure VM power management features</div><div class="line">  --events EVENTS       Configure VM lifecycle management policy</div><div class="line">  --resource RESOURCE   Configure VM resource partitioning (cgroups)</div><div class="line"></div><div class="line">Installations-Verfahren Optionen:</div><div class="line">  --cdrom CDROM         CD-ROM-Installationsmedium</div><div class="line">  -l LOCATION, --location LOCATION</div><div class="line">                        Installationsquelle (z.B. nfs:host:/pfad,</div><div class="line">                        http://host/pfad, ftp://host/pfad)</div><div class="line">  --pxe                 Vom Netzwerk booten mittels PXE-Protokoll</div><div class="line">  --import              Gast um vorhandenes Festplattenimage herum erstellen</div><div class="line">  --livecd              CD-ROM-Medium wie Live-CD behandeln</div><div class="line">  -x EXTRA_ARGS, --extra-args EXTRA_ARGS</div><div class="line">                        Zusätzliche Argumente, die an den Installations</div><div class="line">                        Kernel, der von --location gestartet wird,</div><div class="line">                        weitergegeben werden</div><div class="line">  --initrd-inject INITRD_INJECT</div><div class="line">                        Fügen Sie die angegebene Datei zur Wurzel des initrd</div><div class="line">                        von --location hinzu</div><div class="line">  --os-variant DISTRO_VARIANT</div><div class="line">                        Die zu installierende Betriebssystemvariante für den</div><div class="line">                        Gast, z.B. 'fedora18', 'rhel6', 'winxp', etc.</div><div class="line">  --boot BOOT           Configure guest boot settings. Ex:</div><div class="line">                        --boot hd,cdrom,menu=on</div><div class="line">                        --boot init=/sbin/init (for containers)</div><div class="line">  --idmap IDMAP         Enable user namespace for LXC container. Ex:</div><div class="line">                        --idmap uid_start=0,uid_target=1000,uid_count=10</div><div class="line"></div><div class="line">Speicherkonfiguration:</div><div class="line">  --disk DISK           Specify storage with various options. Ex.</div><div class="line">                        --disk size=10 (new 10GiB image in default location)</div><div class="line">                        --disk path=/my/existing/disk,cache=none</div><div class="line">                        --disk device=cdrom,bus=scsi</div><div class="line">                        --disk=?</div><div class="line">  --nodisks             Keine Festplatten für den Gast einrichten.</div><div class="line">  --filesystem FILESYSTEM</div><div class="line">                        Host-Verzeichnis an Gast übergeben. Beispiel:</div><div class="line">                        --filesystem /my/source/dir,/dir/in/guest</div><div class="line">                        --filesystem template_name,/,type=template</div><div class="line"></div><div class="line">Netzwerke Konfiguration:</div><div class="line">  -w NETWORK, --network NETWORK</div><div class="line">                        Configure a guest network interface. Ex:</div><div class="line">                        --network bridge=mybr0</div><div class="line">                        --network network=my_libvirt_virtual_net</div><div class="line">                        --network network=mynet,model=virtio,mac=00:11...</div><div class="line">                        --network network=mynet,filterref=clean-traffic</div><div class="line">                        --network help</div><div class="line">  --nonetworks          Keine Netzwerkschnittstellen für den Gast erstellen.</div><div class="line"></div><div class="line">Grafikkonfiguration:</div><div class="line">  --graphics GRAPHICS   Konfigurieren Sie Gast-Anzeigeeigenschaften. Beispiel:</div><div class="line">                        --graphics vnc</div><div class="line">                        --graphics spice,port=5901,tlsport=5902</div><div class="line">                        --graphics none</div><div class="line">                        --graphics vnc,password=foobar,port=5910,keymap=ja</div><div class="line"></div><div class="line">Geräteoptionen:</div><div class="line">  --controller CONTROLLER</div><div class="line">                        Konfigurieren Sie ein Gast-Controllergerät. Beispiel:</div><div class="line">                        --controller type=usb,model=ich9-ehci1</div><div class="line">  --serial SERIAL       Konfigurieren Sie ein serielles Gerät für den Gast</div><div class="line">  --parallel PARALLEL   Konfigurieren Sie ein paralleles Gerät für den Gast</div><div class="line">  --channel CHANNEL     Konfigurieren Sie einen Gast-Kommunikationskanal</div><div class="line">  --console CONSOLE     Konfigurieren Sie eine Textkonsolenverbindung zwischen</div><div class="line">                        dem Gast und dem Host</div><div class="line">  --host-device HOST_DEVICE</div><div class="line">                        Konfigurieren Sie physische Host-Geräte verknüpft</div><div class="line">                        mit dem Gast</div><div class="line">  --sound [SOUND]       Konfigurieren Sie Gast-Audiogerät-Emulation</div><div class="line">  --watchdog WATCHDOG   Konfigurieren Sie ein Gast-Watchdog-Gerät</div><div class="line">  --video VIDEO         Konfigurieren Sie Gast-Grafikhardware.</div><div class="line">  --smartcard SMARTCARD</div><div class="line">                        Konfigurieren Sie ein Gast-Smartcard-Gerät. Beispiel:</div><div class="line">                        --smartcard mode=passthrough</div><div class="line">  --redirdev REDIRDEV   Konfigurieren Sie ein Gast-Umleitungsgerät. Beispiel:</div><div class="line">                        --redirdev usb,type=tcp,server=192.168.1.1:4000</div><div class="line">  --memballoon MEMBALLOON</div><div class="line">                        Konfigurieren Sie ein Gast-Memballoon-Gerät. Beispiel:</div><div class="line">                        --memballoon model=virtio</div><div class="line">  --tpm TPM             Configure a guest TPM device. Ex:</div><div class="line">                        --tpm /dev/tpm</div><div class="line">  --rng RNG             Configure a guest RNG device. Ex:</div><div class="line">                        --rng /dev/random</div><div class="line">  --panic PANIC         Configure a guest panic device. Ex:</div><div class="line">                        --panic default</div><div class="line"></div><div class="line">Virtualisierungsplattform-Optionen:</div><div class="line">  -v, --hvm             Dieser Gast soll ein voll virtualisierter Gast sein</div><div class="line">  -p, --paravirt        Dieser Gast soll ein paravirtualisierter Gast sein</div><div class="line">  --container           Dieser Gast soll ein Container-Gast sein</div><div class="line">  --virt-type HV_TYPE   Zu verwendender Hypervisor-Name (kvm, qemu, xen, ...)</div><div class="line">  --arch ARCH           Die zu simulierende CPU-Architektur</div><div class="line">  --machine MACHINE     Der zu emulierende Rechertyp</div><div class="line"></div><div class="line">Sonstige Optionen:</div><div class="line">  --autostart           Domäne soll automatisch nach dem Systemstart des</div><div class="line">                        Hosts starten.</div><div class="line">  --wait WAIT           Minutes to wait for install to complete.</div><div class="line">  --noautoconsole       Nicht automatisch mit der Gastkonsole zu verbinden</div><div class="line">                        versuchen</div><div class="line">  --noreboot            Gast nach abgeschlossener Installation nicht starten.</div><div class="line">  --print-xml           Print the generated domain XML rather than create the</div><div class="line">                        guest.</div><div class="line">  --print-step XMLSTEP  Drucken XML eines bestimmten Installations-Schrittes</div><div class="line">                        (1, 2, 3, alle) anstatt den Gast zu definieren.</div><div class="line">  --dry-run             Führen Sie den Installationsprozess durch, aber ohne</div><div class="line">                        Geräte zu erstellen oder den Gast zu definieren.</div><div class="line">  -q, --quiet           Unterdrücken Fehlerfreie Ausgabe</div><div class="line">  -d, --debug           Debugging-Informationen anzeigen</div><div class="line"></div><div class="line">Use '--option=?' or '--option help' to see available suboptions</div><div class="line">Siehe die man-Seite für Beispiele und kompletter Options-Syntax.</div><div class="line">[root@kvmhost /]#</div></pre></td></tr></table></figure><p><strong>SELinux Virtualbox Image Storage Directory Change:</strong><br></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">mkdir /vm</div><div class="line">semanage fcontext -a -t virt_image_t "/vm(/.*)?"</div><div class="line">restorecon -R /vm</div></pre></td></tr></table></figure><p></p><p><strong>Überprüfen ob Libvirt Daemon korrekt gestartet werden konnte:</strong><br></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">systemctl status libvirtd</div></pre></td></tr></table></figure><p></p><p><em>Log: <code>systemctl status libvirtd</code></em><br></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">[root@kvmhost vm]# systemctl status libvirtd</div><div class="line">libvirtd.service - Virtualization daemon</div><div class="line">   Loaded: loaded (/usr/lib/systemd/system/libvirtd.service; enabled)</div><div class="line">   Active: active (running) since So 2015-10-04 17:00:27 CEST; 8min ago</div><div class="line">     Docs: man:libvirtd(8)</div><div class="line">           http://libvirt.org</div><div class="line"> Main PID: 1603 (libvirtd)</div><div class="line">   CGroup: /system.slice/libvirtd.service</div><div class="line">           └─1603 /usr/sbin/libvirtd</div><div class="line"></div><div class="line">Okt 04 17:00:27 kvmhost.hochguertel.biz systemd[1]: Starting Virtualization daemon...</div><div class="line">Okt 04 17:00:27 kvmhost.hochguertel.biz systemd[1]: Started Virtualization daemon.</div><div class="line">Okt 04 17:00:28 kvmhost.hochguertel.biz libvirtd[1603]: libvirt version: 1.2.8, package: 16.el7_1.4 (CentOS BuildSystem &lt;http://bugs.cent...os.org)</div><div class="line">Okt 04 17:00:28 kvmhost.hochguertel.biz libvirtd[1603]: Kann Bridge virbr0 nicht erstellen: Die Datei existiert bereits</div><div class="line">Hint: Some lines were ellipsized, use -l to show in full.</div></pre></td></tr></table></figure><p></p><p><strong><code>Active: active (running) since So 2015-10-04 17:00:27 CEST; 8min ago</code></strong></p><h3 id="Example-to-add-a-windows-guest"><a href="#Example-to-add-a-windows-guest" class="headerlink" title="Example to add a windows-guest"></a>Example to add a windows-guest</h3><p><strong>List of Operation Systems:</strong><br></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">osinfo-query os</div></pre></td></tr></table></figure><p></p><p><em>Log: <code>osinfo-query os</code></em><br></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">[root@kvmhost vm]# osinfo-query os</div><div class="line"> Short ID             | Name                                               | Version  | ID</div><div class="line">----------------------+----------------------------------------------------+----------+-----------------------------------------</div><div class="line"> altlinux1.0          | Mandrake RE Spring 2001                            | 1.0      | http://altlinux.org/altlinux/1.0</div><div class="line"> altlinux2.0          | ALT Linux 2.0                                      | 2.0      | http://altlinux.org/altlinux/2.0</div><div class="line"> altlinux2.2          | ALT Linux 2.2                                      | 2.2      | http://altlinux.org/altlinux/2.2</div><div class="line"> altlinux2.4          | ALT Linux 2.4                                      | 2.4      | http://altlinux.org/altlinux/2.4</div><div class="line"> altlinux3.0          | ALT Linux 3.0                                      | 3.0      | http://altlinux.org/altlinux/3.0</div><div class="line"> altlinux4.0          | ALT Linux 4.0                                      | 4.0      | http://altlinux.org/altlinux/4.0</div><div class="line"> altlinux4.1          | ALT Linux 4.1                                      | 4.1      | http://altlinux.org/altlinux/4.1</div><div class="line"> altlinux5            | ALT Linux 5.0.0 Ark                                | 5.0      | http://altlinux.org/altlinux/5</div><div class="line"> altlinux6            | ALT Linux 6.0.0 Centaurus                          | 6.0      | http://altlinux.org/altlinux/6</div><div class="line">....</div></pre></td></tr></table></figure><p></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">virt-install --connect qemu:///system \</div><div class="line"> -n vmwin7 \</div><div class="line"> -r 512 \</div><div class="line"> --vcpus=1 \</div><div class="line"> --disk path=/vm/vmwin7.img,size=10 \</div><div class="line"> --graphics vnc,listen=0.0.0.0 \</div><div class="line"> --noautoconsole \</div><div class="line"> --os-type windows \</div><div class="line"> --os-variant win7 \</div><div class="line"> --accelerate \</div><div class="line"> --network=bridge:virbr0 \</div><div class="line"> --hvm \</div><div class="line"> --cdrom /vm/03_Installation-Medium/X17-58997.iso</div></pre></td></tr></table></figure><p><code>–connect qemu:///system</code> : connect to KVM on the local system, we could also connect to another KVM-host and define our new VM there<br><code>-n vmwin7</code> : name of the new VM: vmwin7<br><code>-r 512</code> : amount of memory for the VM: 1GB<br><code>–vcpus=1</code> : amount of virtual CPU’s for the VM: 2<br><code>–disk path=/var/lib/libvirt/images/vmwin7.img,size=10</code> : where to store the virtual disk image of the VM and the size: 10GB<br><code>–graphics vnc,listen=0.0.0.0</code> : how to display the VM’s console: via VNC accessible from outside<br><code>–noautoconsole</code> : do not automatically connect to the console<br><code>–os-type windows –os-variant win7</code> : type of guest OS (from the list given above)<br><code>–accelerate</code> : use KVM HW-acceleration<br><code>–network=bridge:virbr0</code> : network bridge to use<br><code>–hvm</code> : full virtualisation<br><code>–cdrom /vm/03_Installation-Medium/X17-58997.iso</code> : location of the installation ISO</p><p><em>Log: ``</em><br></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">[root@kvmhost vm]# virt-install --connect qemu:///system \</div><div class="line"><span class="meta">&gt;</span>  -n vmwin7 \</div><div class="line"><span class="meta">&gt;</span>  -r 512 \</div><div class="line"><span class="meta">&gt;</span>  --vcpus=1 \</div><div class="line"><span class="meta">&gt;</span>  --disk path=/vm/vmwin7.img,size=10 \</div><div class="line"><span class="meta">&gt;</span>  --graphics vnc,listen=0.0.0.0 \</div><div class="line"><span class="meta">&gt;</span>  --noautoconsole \</div><div class="line"><span class="meta">&gt;</span>  --os-type windows \</div><div class="line"><span class="meta">&gt;</span>  --os-variant win7 \</div><div class="line"><span class="meta">&gt;</span>  --accelerate \</div><div class="line"><span class="meta">&gt;</span>  --network=bridge:virbr0 \</div><div class="line"><span class="meta">&gt;</span>  --hvm \</div><div class="line"><span class="meta">&gt;</span>  --cdrom /vm/03_Installation-Medium/X17-58997.iso</div><div class="line"></div><div class="line">Installation wird gestartet...</div><div class="line">Zuweisen von 'vmwin7.img'                                                                                                             |  10 GB  00:00:00</div><div class="line">Domain wird erstellt...                                                                                                               |    0 B  00:00:00</div><div class="line">Domain-Installation ist noch in Arbeit. Warten  für die Installation fertigzustellen.</div></pre></td></tr></table></figure><p></p><h3 id="Exmaple-of-adding-KVM-Guests"><a href="#Exmaple-of-adding-KVM-Guests" class="headerlink" title="Exmaple of adding KVM Guests"></a>Exmaple of adding KVM Guests</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">virt-install --connect qemu:///system \</div><div class="line"> -n vm001 \</div><div class="line"> -r 512 \</div><div class="line"> --vcpus=1 \</div><div class="line"> --disk path=/vm/vm001.img,size=10 \</div><div class="line"> --graphics vnc,listen=0.0.0.0 \</div><div class="line"> --noautoconsole \</div><div class="line"> --os-type linux \</div><div class="line"> --os-variant centos7.0 \</div><div class="line"> --accelerate \</div><div class="line"> --network=bridge:virbr0 \</div><div class="line"> --hvm \</div><div class="line"> --cdrom /vm/03_Installation-Medium/CentOS-7-x86_64-DVD-1503-01.iso</div></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">virt-install --connect qemu:///system \</div><div class="line"> -n vm002 \</div><div class="line"> -r 512 \</div><div class="line"> --vcpus=1 \</div><div class="line"> --disk path=/vm/vm002.img,size=10 \</div><div class="line"> --graphics vnc,listen=0.0.0.0 \</div><div class="line"> --noautoconsole \</div><div class="line"> --os-type linux \</div><div class="line"> --os-variant centos7.0 \</div><div class="line"> --accelerate \</div><div class="line"> --network=bridge:virbr0 \</div><div class="line"> --hvm \</div><div class="line"> --cdrom /vm/03_Installation-Medium/CentOS-7-x86_64-DVD-1503-01.iso</div></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">virt-install --connect qemu:///system \</div><div class="line"> -n vm003 \</div><div class="line"> -r 512 \</div><div class="line"> --vcpus=1 \</div><div class="line"> --disk path=/vm/vm003.img,size=10 \</div><div class="line"> --graphics vnc,listen=0.0.0.0 \</div><div class="line"> --noautoconsole \</div><div class="line"> --os-type linux \</div><div class="line"> --os-variant centos7.0 \</div><div class="line"> --accelerate \</div><div class="line"> --network=bridge:virbr0 \</div><div class="line"> --hvm \</div><div class="line"> --cdrom /vm/03_Installation-Medium/CentOS-7-x86_64-DVD-1503-01.iso</div></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">virt-install --connect qemu:///system \</div><div class="line"> -n vm004 \</div><div class="line"> -r 512 \</div><div class="line"> --vcpus=1 \</div><div class="line"> --disk path=/vm/vm004.img,size=10 \</div><div class="line"> --graphics vnc,listen=0.0.0.0 \</div><div class="line"> --noautoconsole \</div><div class="line"> --os-type linux \</div><div class="line"> --os-variant centos7.0 \</div><div class="line"> --accelerate \</div><div class="line"> --network=bridge:virbr0 \</div><div class="line"> --hvm \</div><div class="line"> --cdrom /vm/03_Installation-Medium/CentOS-7-x86_64-DVD-1503-01.iso</div></pre></td></tr></table></figure><h3 id="Open-VNC-Ports-in-Firewall"><a href="#Open-VNC-Ports-in-Firewall" class="headerlink" title="Open VNC Ports in Firewall"></a>Open VNC Ports in Firewall</h3><ul><li><a href="http://www.certdepot.net/rhel7-get-started-firewalld/" target="_blank" rel="external">rhel7-get-started-firewalld</a></li></ul><p><strong>To add a source (here 192.168.2.0/24) to a zone (here trusted) permanently, type:</strong><br></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">firewall-cmd --permanent --zone=trusted --add-source=192.168.2.0/24</div><div class="line">firewall-cmd --reload</div></pre></td></tr></table></figure><p></p><h3 id="Connect-via-VNC-to-Virtual-Machine"><a href="#Connect-via-VNC-to-Virtual-Machine" class="headerlink" title="Connect via VNC to Virtual Machine:"></a>Connect via VNC to Virtual Machine:</h3><p><strong>Getting the Screen-Number:</strong><br></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">virsh vncdisplay vmwin7</div><div class="line">netstat -tln|grep :59</div></pre></td></tr></table></figure><p></p><p><em>Log: <code>virsh vncdisplay vmwin7</code></em><br></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[root@kvmhost ~]# virsh vncdisplay vmwin7</div><div class="line">:0</div><div class="line"></div><div class="line">[root@kvmhost ~]#</div></pre></td></tr></table></figure><p></p><p><em>Log: <code>netstat -tln|grep :59</code></em><br></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[root@kvmhost ~]# netstat -tln|grep :59</div><div class="line">tcp        0      0 0.0.0.0:5900            0.0.0.0:*               LISTEN</div><div class="line">[root@kvmhost ~]#</div></pre></td></tr></table></figure><p></p><img src="/blog/2017/06/13/KVM-HOST-CentOS-7-Virtualization-Host/KVM-HOST-CentOS-7-Virtualization-Host0.png" alt="Figure: Connect to the screen of KVM VM" title="Figure: Connect to the screen of KVM VM"><p>192.168.2.22:5900<br>kvmhost:5900<br>spice://kvmhost:5900</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">virt-install --connect qemu:///system \</div><div class="line"> -n vmwin7 \</div><div class="line"> -r 512 \</div><div class="line"> --vcpus=1 \</div><div class="line"> --disk path=/vm/vmwin7.img,size=10 \</div><div class="line"> --graphics spice,listen=0.0.0.0 \</div><div class="line"> --noautoconsole \</div><div class="line"> --os-type windows \</div><div class="line"> --os-variant win7 \</div><div class="line"> --accelerate \</div><div class="line"> --network=bridge:virbr0 \</div><div class="line"> --hvm \</div><div class="line"> --cdrom /vm/03_Installation-Medium/X17-58997.iso</div></pre></td></tr></table></figure><p><strong>Remove Virtual Machine from Virtual Manager and Harddisk:</strong><br></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">virsh destroy vmwin7</div><div class="line">virsh undefine vmwin7</div><div class="line">rm -rf /vm/vmwin7.img</div></pre></td></tr></table></figure><p></p><ul><li><a href="https://raymii.org/s/articles/virt-install_introduction_and_copy_paste_distro_install_commands.html" target="_blank" rel="external">Installing Virtual Machines with virt-install, plus copy pastable distro install one-liners</a></li></ul></div><div></div><div></div><div></div><footer class="post-footer"><div class="post-tags"><a href="/blog/tags/KVM/" rel="tag"># KVM</a> <a href="/blog/tags/virt-install/" rel="tag"># virt-install</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"><a href="/blog/2017/06/14/OpenShift-Host/" rel="prev" title="OpenShift Host">OpenShift Host <i class="fa fa-chevron-right"></i></a></div></div></footer></article><div class="post-spread"></div></div></div><div class="comments" id="comments"></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">Table of Contents</li></ul><section class="post-toc-wrap sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#CENTOS-7-VIRTUALIZATION-HOST"><span class="nav-number">1.</span> <span class="nav-text">CENTOS 7 VIRTUALIZATION HOST</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#KVM-hypervisor-and-VM-extensions"><span class="nav-number">1.1.</span> <span class="nav-text">KVM hypervisor and VM-extensions</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#KVM-installation"><span class="nav-number">1.1.1.</span> <span class="nav-text">KVM installation</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Networking"><span class="nav-number">1.1.2.</span> <span class="nav-text">Networking</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Finish-and-check-the-KVM-installation"><span class="nav-number">1.1.3.</span> <span class="nav-text">Finish and check the KVM installation</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Using-KVM-with-the-CLI"><span class="nav-number">1.2.</span> <span class="nav-text">Using KVM with the CLI</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Example-to-add-a-windows-guest"><span class="nav-number">1.2.1.</span> <span class="nav-text">Example to add a windows-guest</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Exmaple-of-adding-KVM-Guests"><span class="nav-number">1.2.2.</span> <span class="nav-text">Exmaple of adding KVM Guests</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Open-VNC-Ports-in-Firewall"><span class="nav-number">1.2.3.</span> <span class="nav-text">Open VNC Ports in Firewall</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Connect-via-VNC-to-Virtual-Machine"><span class="nav-number">1.2.4.</span> <span class="nav-text">Connect via VNC to Virtual Machine:</span></a></li></ol></li></ol></li></ol></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2017</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">Tobias Hochgürtel</span></div><div class="powered-by">Powered by <a class="theme-link" href="https://hexo.io">Hexo</a></div><div class="theme-info">Theme - <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span id="scrollpercent"><span>0</span>%</span></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/blog/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/blog/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/blog/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/blog/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/blog/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/blog/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/blog/js/src/utils.js?v=5.1.1"></script><script type="text/javascript" src="/blog/js/src/motion.js?v=5.1.1"></script><script type="text/javascript" src="/blog/js/src/scrollspy.js?v=5.1.1"></script><script type="text/javascript" src="/blog/js/src/post-details.js?v=5.1.1"></script><script type="text/javascript" src="/blog/js/src/bootstrap.js?v=5.1.1"></script><script type="text/javascript">function proceedsearch(){$("body").append('<div class="search-popup-overlay local-search-pop-overlay"></div>').css("overflow","hidden"),$(".search-popup-overlay").click(onPopupClose),$(".popup").toggle();var t=$("#local-search-input");t.attr("autocapitalize","none"),t.attr("autocorrect","off"),t.focus()}var isfetched=!1,isXml=!0,search_path="search.xml";0===search_path.length?search_path="search.xml":/json$/i.test(search_path)&&(isXml=!1);var path="/blog/"+search_path,onPopupClose=function(t){$(".popup").hide(),$("#local-search-input").val(""),$(".search-result-list").remove(),$("#no-result").remove(),$(".local-search-pop-overlay").remove(),$("body").css("overflow","")},searchFunc=function(t,e,o){"use strict";$("body").append('<div class="search-popup-overlay local-search-pop-overlay"><div id="search-loading-icon"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div>').css("overflow","hidden"),$("#search-loading-icon").css("margin","20% auto 0 auto").css("text-align","center"),$.ajax({url:t,dataType:isXml?"xml":"json",async:!0,success:function(t){isfetched=!0,$(".popup").detach().appendTo(".header-inner");var n=isXml?$("entry",t).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get():t,r=document.getElementById(e),s=document.getElementById(o),a=function(){var t=r.value.trim().toLowerCase(),e=t.split(/[\s\-]+/);e.length>1&&e.push(t);var o=[];if(t.length>0&&n.forEach(function(n){var r=!1,s=0,a=0,i=n.title.trim(),c=i.toLowerCase(),l=n.content.trim().replace(/<[^>]+>/g,""),h=l.toLowerCase(),p=decodeURIComponent(n.url),u=[],f=[];if(""!=i&&(e.forEach(function(t){function e(t,e,o){var n=t.length;if(0===n)return[];var r=0,s=[],a=[];for(o||(e=e.toLowerCase(),t=t.toLowerCase());(s=e.indexOf(t,r))>-1;)a.push({position:s,word:t}),r=s+n;return a}u=u.concat(e(t,c,!1)),f=f.concat(e(t,h,!1))}),(u.length>0||f.length>0)&&(r=!0,s=u.length+f.length)),r){[u,f].forEach(function(t){t.sort(function(t,e){return e.position!==t.position?e.position-t.position:t.word.length-e.word.length})});function d(e,o,n,r){for(var s=r[r.length-1],i=s.position,c=s.word,l=[],h=0;i+c.length<=n&&0!=r.length;){c===t&&h++,l.push({position:i,length:c.length});var p=i+c.length;for(r.pop();0!=r.length&&(s=r[r.length-1],i=s.position,c=s.word,p>i);)r.pop()}return a+=h,{hits:l,start:o,end:n,searchTextCount:h}}var g=[];0!=u.length&&g.push(d(i,0,i.length,u));for(var v=[];0!=f.length;){var $=f[f.length-1],C=$.position,m=$.word,x=C-20,w=C+80;x<0&&(x=0),w<C+m.length&&(w=C+m.length),w>l.length&&(w=l.length),v.push(d(l,x,w,f))}v.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hits.length!==e.hits.length?e.hits.length-t.hits.length:t.start-e.start});var y=parseInt("1");y>=0&&(v=v.slice(0,y));function T(t,e){var o="",n=e.start;return e.hits.forEach(function(e){o+=t.substring(n,e.position);var r=e.position+e.length;o+='<b class="search-keyword">'+t.substring(e.position,r)+"</b>",n=r}),o+=t.substring(n,e.end)}var b="";0!=g.length?b+="<li><a href='"+p+"' class='search-result-title'>"+T(i,g[0])+"</a>":b+="<li><a href='"+p+"' class='search-result-title'>"+i+"</a>",v.forEach(function(t){b+="<a href='"+p+'\'><p class="search-result">'+T(l,t)+"...</p></a>"}),b+="</li>",o.push({item:b,searchTextCount:a,hitCount:s,id:o.length})}}),1===e.length&&""===e[0])s.innerHTML='<div id="no-result"><i class="fa fa-search fa-5x" /></div>';else if(0===o.length)s.innerHTML='<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>';else{o.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hitCount!==e.hitCount?e.hitCount-t.hitCount:e.id-t.id});var a='<ul class="search-result-list">';o.forEach(function(t){a+=t.item}),a+="</ul>",s.innerHTML=a}};r.addEventListener("input",a),$(".local-search-pop-overlay").remove(),$("body").css("overflow",""),proceedsearch()}})};$(".popup-trigger").click(function(t){t.stopPropagation(),!1===isfetched?searchFunc(path,"local-search-input","local-search-result"):proceedsearch()}),$(".popup-btn-close").click(onPopupClose),$(".popup").click(function(t){t.stopPropagation()}),$(document).on("keyup",function(t){27===t.which&&$(".search-popup").is(":visible")&&onPopupClose()})</script></body></html>